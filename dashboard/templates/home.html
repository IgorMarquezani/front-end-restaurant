{{define "Home"}}

<!DOCTYPE html>
<html dir="ltr" lang="pt-br">

<head>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.8/dist/sweetalert2.all.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.8/dist/sweetalert2.min.css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"> -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <!-- Tell the browser to be responsive to screen width -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="keywords"
    content="wrappixel, admin dashboard, html css dashboard, web dashboard, bootstrap 5 admin, bootstrap 5, css3 dashboard, bootstrap 5 dashboard, Ample lite admin bootstrap 5 dashboard, frontend, responsive bootstrap 5 admin template, Ample admin lite dashboard bootstrap 5 dashboard template">
  <meta name="description"
    content="Ample Admin Lite is powerful and clean admin dashboard template, inpired from Bootstrap Framework">
  <meta name="robots" content="noindex,nofollow">
  <title>Restaurant</title>
  <link rel="canonical" href="https://www.wrappixel.com/templates/ample-admin-lite/" />
  <!-- Favicon icon -->
  <link rel="icon" type="image/png" sizes="16x16" href="/templates/plugins/images/favicon.png">
  <!-- Custom CSS -->
  <link href="/templates/css/tabs.css" rel="stylesheet">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
    integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <link rel="stylesheet" href="/templates/plugins/bower_components/chartist/dist/chartist.min.css">
  <link rel="stylesheet"
    href="/templates/plugins/bower_components/chartist-plugin-tooltips/dist/chartist-plugin-tooltip.css">
  <link rel="stylesheet" href="/templates/css/style.min.css">
  <link rel="stylesheet" href="/templates/css/newstyle.css">
  <link rel="stylesheet" href="/templates/css/icons/font-awesome/css/fontawesome-all.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css">
  <link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/css/bootstrap-select.css" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/js/bootstrap-select.min.js"></script>
  <script src="/templates/js/rooms.js"></script>
  <script src="/templates/js/invites.js"></script>
  <script src="/templates/js/tabs.js"> </script>
</head>

<body>
  <!-- ============================================================== -->
  <!-- Preloader - style you can find in spinners.css -->
  <!-- ============================================================== -->
  <!-- <div class="preloader">
        <div class="lds-ripple">
            <div class="lds-pos"></div>
            <div class="lds-pos"></div>
        </div>
    </div> -->
  <!-- ============================================================== -->
  <!-- Main wrapper - style you can find in pages.scss -->
  <!-- ============================================================== -->
  <div id="main-wrapper" data-layout="vertical" data-navbarbg="skin5" data-sidebartype="full"
    data-sidebar-position="absolute" data-header-position="relative" data-boxed-layout="full" height="100%"
    weight="100%">
    {{template "_header" .}}
    {{template "_aside" .}}
    <!-- ============================================================== -->
    <!-- Page wrapper  -->
    <!-- ============================================================== -->
    <div class="page-wrapper">
      <!-- ============================================================== -->
      <!-- Bread crumb and right sidebar toggle -->
      <!-- ============================================================== -->
      <div class="page-breadcrumb bg-white">
        <div class="row align-items-left">
          <div class="col-lg-0 col-md-4 col-sm-4 col-xs-12">
            <table>
              <td padding-right="2px">
                <h4 class="page-title">Restaurantes:</h4>
              </td>
              <td padding-right="2px">
                <a href="#" data-room-id="{{.Room.Id}}"
                  class="btn btn-primary btn-sm room-link active">{{.Room.Id}}</a>
              </td>
              {{range $index, $room :=.RoomsAsGuest}}
              <td padding-right="2px">
                <a href="#" data-room-id="{{$room.Id}}"
                  class="btn btn-primary btn-sm room-link">{{$room.Id}}</a>
              </td>
              {{end}}
            </table>

            <!-- <table> -->
            <!--   <td padding-right="2px"> -->
            <!--     <h4 class="page-title">Restaurantes:</h4> -->
            <!--   </td> -->
            <!--   <td padding-right="2px"> -->
            <!--     <a href="http://localhost:8081/room?id={{.Room.Id}}" target="tabs-iframe" name="room-{{.Room.Id}}" -->
            <!--       type="button" class="btn btn-primary btn-sm" value="{{.Room.Id}}" -->
            <!--       onclick="updateActiveRoom('{{.Room.Id}}')">{{.Room.Id}}</a> -->
            <!--   </td> -->
            <!--   {{range $index, $room :=.RoomsAsGuest}} -->
            <!--   <td padding-right="2px"> -->
            <!--     <a href="http://localhost:8081/room?id={{$room.Id}}" target="tabs-iframe" name="room-{{$room.Id}}" -->
            <!--       type="button" class="btn btn-primary btn-sm" value="{{$room.Id}}" -->
            <!--       onclick="updateActiveRoom('{{$room.Id}}')">{{$room.Id}}</a> -->
            <!--   </td> -->
            <!--   {{end}} -->
            <!-- </table> -->

          </div>
        </div>
      </div>
      <!-- /.col-lg-12 -->
      <div class="page-breadcrumb bg-white">
        <div class="row align-items-center">
          <div class="col-lg-3 col-md-4 col-sm-4 col-xs-12">
            <h4 class="page-title">Comandas:</h4>
          </div>
        </div>
      </div>
      <div class="myIframe">
        <div id="tabs-container"></div>
      </div>
    </div>

    <div id="invitemodal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-body">
            <div class="text-center mt-2 mb-4">
              <label>Formulário de convite</label>
            </div>
            <div class="mb-3">
              <label for="username">E-mail do usuário: </label>
              <input class="form-control" type="email" id="convidado" required="" placeholder="">
            </div>
            <div class="mb-3">
              <select id="permissionDropdown">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
              </select>
            </div>
            <div class="mb-3 text-center">
              <button class="btn btn-primary" type="submit" onclick="sendInvite()">Convidar</button>
            </div>
          </div>
        </div>
        <!-- /.modal-content -->
      </div>
      <!-- /.modal-dialog -->
    </div>
    <!-- /.modal -->
  </div>
  <footer class="footer text-center">
    2022 © Fatec Ourinhos
  </footer>

  <!-- ============================================================== -->
  <!-- End footer -->
  <!-- ============================================================== -->

  <!-- ============================================================== -->
  <!-- End Page wrapper  -->
  <!-- ============================================================== -->
  <!-- End Wrapper -->
  <!-- ============================================================== -->
  <!-- ============================================================== -->
  <!-- All Jquery -->
  <!-- ============================================================== -->
  <script>$('select').selectpicker();</script>
  <script src="/templates/plugins/bower_components/jquery/dist/jquery.min.js"></script>
  <!-- Bootstrap tether Core JavaScript -->
  <script src="/templates/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
  <script src="/templates/js/app-style-switcher.js"></script>
  <script src="/templates/plugins/bower_components/jquery-sparkline/jquery.sparkline.min.js"></script>
  <!--Wave Effects -->
  <script src="/templates/js/waves.js"></script>
  <!--Menu sidebar -->
  <script src="/templates/js/sidebarmenu.js"></script>
  <!--Custom JavaScript -->
  <script src="/templates/js/custom.js"></script>
  <!--This page JavaScript -->
  <!--chartis chart-->
  <script src="/templates/plugins/bower_components/chartist/dist/chartist.min.js"></script>
  <script
    src="/templates/plugins/bower_components/chartist-plugin-tooltips/dist/chartist-plugin-tooltip.min.js"></script>
  <script src="/templates/js/pages/dashboards/dashboard1.js"></script>
  <script src="/templates/js/tabs.js"> </script>
  <script>
    // Get the tabs container div
    var socket
    var tabsContainer = document.getElementById('tabs-container');

    // Add event listener to all room links
    var roomLinks = document.querySelectorAll('.room-link');
    roomLinks.forEach(function (link) {
      link.addEventListener('click', function (event) {
        event.preventDefault();

        // Get the ID of the clicked room
        var roomId = this.getAttribute('data-room-id');
        updateActiveRoom(roomId)

        if (socket != null) {
          socket.close()
        }

        socket = new WebSocket('ws://localhost:3300/api/tab/websocket/' + roomId)
        socket.onopen = (event) => console.log('WebSocket Created')
        socket.onmessage = (msg) => renderTabFromWebsocket(msg.data)
        socket.onerror = (error) => console.error('Web Socket Error:', error)
        socket.onclose = (event) => console.log('Disconnected')

        // Update the active room link
        roomLinks.forEach(function (link) {
          link.classList.remove('active');
        });
        this.classList.add('active');

        // Load the room content into the tabs container
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function () {
          if (this.readyState === 4 && this.status === 200) {
            tabsContainer.innerHTML = this.responseText;
          }
        };

        xhr.open('GET', 'http://localhost:8081/room?id=' + roomId, true);
        xhr.send();
      });
    });
  </script>
</body>

</html>

{{end}}
